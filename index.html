<html>

<head>
    <title>Caliper JS Sensor Test Page</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.js"></script>
    <script src="dist/caliperSensor-0.1.0.js"></script>
</head>

<body>
    <h1>Caliper JS Sensor Test</h1>

    <script type="text/javascript">
    $(document).ready(function() {

        // Initialize sensor with options
        var sensor = window.Caliper.Sensor;

        sensor.initialize({host: 'lvh.me', port: '1080', path: '/1.0/event/put'});

        var event = new Caliper.Event();
        event.setContext('http://purl.imsglobal.org/ctx/caliper/v1/NavigationEvent');
        event.setType('http://purl.imsglobal.org/caliper/v1/NavigationEvent');
        event.setActor({id: 'jsmith-1234'});
        event.setAction('navigatedTo');
        event.setObject({id: 'sfsaffsdfs', type: 'epubPart'});
        console.log('created event ' + JSON.stringify(event)); 

        var currentTimeMillis = (new Date()).getTime();

        var eventEnvelope = {};
        eventEnvelope['_id'] = 'caliper-js' + currentTimeMillis;
        eventEnvelope.d = event;
        console.log('created event envelope ' + JSON.stringify(eventEnvelope));

        sensor.send(eventEnvelope);

    });
    </script>

</body>

</html>
